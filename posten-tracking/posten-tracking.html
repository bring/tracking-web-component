<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../posten-tracking-search/posten-tracking-search.html">

<polymer-element name="posten-tracking" attributes="trackingNumber language" layout vertical>
  <template>
    <link rel="stylesheet" href="posten-tracking.css">

    <div layout horizontal center>
      <div class="package" hidden?={{!package}}></div>
      <div>
        <h1 class="small">{{package.packageNumber}}</h1>
        <div id="status">
          <div class="error" hidden?="{{!error}}"></div>
          <h3 class="small">{{language | i18n(error.code)}}</h3>
        </div>
        {{package.statusDescription || package.eventSet[0].description}}
      </div>
    </div>
    <posten-tracking-search trackingNumber="{{trackingNumber}}" package="{{package}}" error="{{error}}" language="{{language}}"></posten-tracking-search>
  </template>
  <script>
    Polymer("posten-tracking", {
        ready: function() {
            this.language = this.isLegalLanguage() ? this.language : 'no';
        },
        i18n: function(language, key) {
            if(this.texts[key] && this.texts[key][language]) {
                return this.texts[key][language];
            }
            return '';
        },
        isLegalLanguage: function() {
            var legalLanguages = ['no', 'en', 'da', 'sv'];
            return _.contains(legalLanguages, this.language);
        },
        texts: {
            '404': {
                no: 'Ingen sending funnet',
                en: 'No shipments found',
                da: 'Der blev ikke fundet nogen forsendelse',
                sv: 'Ingen sändning hittades'
            },
            '500': {
                no: 'Feil ved henting av sporingsinformasjon',
                en: 'Error getting track & trace information',
                da: 'Der opstod en fejl ved hentning af sporingsinformation',
                sv: 'Fel vid hämtning av tracking-information'
            }
        }
    });
  </script>
</polymer-element>
